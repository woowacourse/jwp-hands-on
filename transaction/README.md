# νΈλμ­μ…κ³Ό μ¤ν”„λ§ νΈλμ­μ…

## ν•™μµ λ©ν‘

- λ°μ΄ν„°λ² μ΄μ¤ νΈλμ­μ…μ— λ€ν•΄ ν•™μµν•λ‹¤.
- μ¤ν”„λ§μ—μ„ μ§€μ›ν•λ” νΈλμ­μ…μ„ ν•™μµν•λ‹¤.

## ν•™μµ μμ„

- νΈλμ­μ…μ— λ€ν• κ°λ… μ •λ¦¬
- ν•™μµν• λ‚΄μ©μ„ λ°”νƒ•μΌλ΅ μ‹¤μµ μ§„ν–‰ν•λ‹¤.
    - νΈλμ­μ… κ²©λ¦¬ λ λ²¨μ΄ μ‹¤μ λ΅ μ–΄λ–»κ² λ™μ‘ν•λ”μ§€ stage0μ—μ„ ν™•μΈν•λ‹¤.
    - νΈλμ­μ… μ „νκ°€ μ‹¤μ λ΅ μ–΄λ–»κ² λ™μ‘ν•λ”μ§€ stage1μ—μ„ ν™•μΈν•λ‹¤.

## μ €μ¥μ†

- jwp-hands-on - transaction

## νΈλμ­μ…μ΄λ€?

- Database transaction
- **λ°μ΄ν„°μ μ •ν•©μ„±μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ κ³ μ•λ λ°©λ²•**μ΄λ‹¤.
- λ‹¤λ¥Έ νΈλμ­μ…κ³Ό λ…λ¦½μ μ΄κ³  μΌκ΄€λκ³  μ‹ λΆ°ν•  μ μλ” λ°©μ‹μΌλ΅ μ²λ¦¬λμ–΄μ•Ό ν•λ‹¤.
- νΈλμ­μ…μ λ©μ 
    - **μ¤λ¥λ΅λ¶€ν„° λ³µκµ¬λ¥Ό ν—μ©**ν•κ³  λ°μ΄ν„°λ² μ΄μ¤λ¥Ό **μΌκ΄€μ„± μκ² μ μ§€**ν•λ” μ•μ •μ μΈ μ‘μ—… λ‹¨μ„λ¥Ό μ κ³µν•λ‹¤.
    - **λ™μ‹μ— μ ‘κ·Ό**ν•λ” μ—¬λ¬ **ν”„λ΅κ·Έλ¨ κ°„μ— κ²©λ¦¬**λ¥Ό μ κ³µν•λ‹¤.

## ACID

- μ•μ—μ„ μ„¤λ…ν• νΈλμ­μ…μ λ©μ μ„ λ‹¬μ„±ν•κΈ° μ„ν•΄ νΈλμ­μ…μ΄ κ°€μ Έμ•Ό ν•λ” μ†μ„±
- `μ›μμ„±(Atomicity)`
    - νΈλμ­μ…μ— ν¬ν•¨λ λ¨λ“  μ‘μ—…μ΄ λ¨λ‘ μ„±κ³µ(Commit)ν•κ±°λ‚ μ‹¤ν¨(Rollback)ν•΄μ•Ό ν•λ‹¤.
- `μΌκ΄€μ„±(Consistency)`
    - νΈλμ­μ…μ„ μ‹¤ν–‰ν• μ „ν›„μ—λ” λ°μ΄ν„°μ μΌκ΄€μ„±μ΄ μ†μƒλμ§€ μ•μ•„μ•Ό ν•λ‹¤.
- `κ²©λ¦¬μ„±(λ…λ¦½μ„±)(Isolation)`
    - λ™μ‹μ— μ‹¤ν–‰ν•λ” μ—¬λ¬ κ°μ νΈλμ­μ…μ΄ μ„λ΅ μν–¥μ„ μ£Όμ§€ μ•μ•„μ•Ό ν•λ‹¤.
- `μμ†μ„±(μ§€μ†μ„±)(Durability)`
    - μ»¤λ°‹μ΄ μ™„λ£λ νΈλμ­μ…μ€ μ†μƒλμ§€ μ•λ” μ„±μ§μ„ λ§ν•λ‹¤.

## Isolation Level

- νΈλμ­μ…μ΄ μ–Όλ§λ‚ μ„λ΅ λ…λ¦½μ μΈμ§€ λ‚νƒ€λ‚΄λ” κ°λ…μ΄λ‹¤.
    - μ™ νΈλμ­μ…μ΄ λ…λ¦½μ μ΄μ–΄μ•Ό ν• κΉ?
        - λ‹¤μ–‘ν• **λΉ„μ •μƒ(Anomaly) μƒνƒ, ν„μƒμ„ λ°©μ§€**ν•κΈ° μ„ν•΄μ„λ‹¤.
    - λΉ„μ •μƒμ μΈ μƒνƒκ°€ μ™ λ‚νƒ€λ‚λ”κ°€?
        - λ™μ‹μ— μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ λ°μ΄ν„°μ— μ ‘κ·Όν•κ³  μμ •ν•κΈ° λ•λ¬Έμ΄λ‹¤.
    - μ–΄λ–¤ μ½κΈ° ν„μƒμ΄ λ°μƒ ν•  μ μμ„κΉ?
        - **Dirty reads**
        - **Non-repeatable reads**
        - **Phantom reads**
- κ²©λ¦¬ λ λ²¨μ€ μ–΄λ–¤ κ²ƒμ΄ μμ„κΉ?
    - **Read Uncommitted**
    - **Read Committed**
    - **Repeatable Read**
    - **Serializable**
- κ²©λ¦¬ λ λ²¨μ— λ”°λΌ μ–΄λ–¤ ν„μƒμ΄ λ°μƒν•λ”μ§€ μ‹¤μµμ—μ„ κ΄€μ°°ν•΄λ³΄μ.

## Propagation

- νΈλμ­μ…μ κ²½κ³„μ—μ„ μ΄λ―Έ μ§„ν–‰ μ¤‘μΈ νΈλμ­μ…μ΄ μμ„ λ• λλ” μ—†μ„ λ• μ–΄λ–»κ² λ™μ‘ν•  κ²ƒμΈκ°€λ¥Ό κ²°μ •ν•λ” λ°©μ‹μ„ λ§ν•λ‹¤.
- μ–΄λ–¤ νΈλμ­μ… μ „νκ°€ μλ”μ§€ μ‹¤μµμ„ ν†µν•΄ ν™•μΈν•μ.

## μ‹¤μµ μ”κµ¬ μ‚¬ν•­

- stage0λ” ACIDκ°€ κ°κ° μ–΄λ–¤ κ²ƒμ„ μλ―Έν•λ”μ§€ ν•™μµν•κ³  ν…μ¤νΈλ¥Ό ν†µκ³Όμ‹ν‚¨λ‹¤.
- stage1μ€ κ²©λ¦¬ λ λ²¨μ— λ”°λΌ λ°μƒν•λ” ν„μƒμ„ κ΄€μ°°ν•κ³  μ£Όμ„μ ν‘λ¥Ό μ±„μ΄λ‹¤.
- stage2λ” μ „νμ— λ”°λ¥Έ ν„μƒμ„ κ΄€μ°°ν•κ³  ν…μ¤νΈλ¥Ό ν†µκ³Όμ‹ν‚¨λ‹¤.

### 0λ‹¨κ³„ - ACID

- ACIDκ°€ μ–΄λ–¤ μλ―ΈμΈμ§€ ν•™μµν•κ³  ν…μ¤νΈλ¥Ό ν†µκ³Όμ‹μΌλ³΄μ.

### 1λ‹¨κ³„ - Isolation Level

- κ²©λ¦¬ λ λ²¨(isolation level)μ„ ν•™μµν•κ³  μ‹¤μ λ΅ μ–΄λ–¤ ν„μƒμ΄ λ°μƒν•λ”μ§€ ν…μ¤νΈλ΅ ν™•μΈν•΄λ³΄μ.
- phantomReading() ν…μ¤νΈ μΌ€μ΄μ¤λ” Docker π³λ¥Ό μ‹¤ν–‰ν• μƒνƒμ—μ„ ν…μ¤νΈλ¥Ό λλ ¤μ•Ό μ •μƒ λ™μ‘ν•λ‹¤.

### 2λ‹¨κ³„ - Propagation

- @Transactionalμ μ†μ„± μ¤‘μ— propagationμ΄ μλ‹¤. DBμ— μ—†λ” κΈ°λ¥μ„ μ™ μ¤ν”„λ§μ—μ„ μ κ³µν• κΉ?
- ν…μ¤νΈλ¥Ό λλ ¤λ³΄κ³  μ½μ†”μ°½μ—μ„ μμƒν–λ λ€λ΅ νΈλμ­μ…μ΄ λ™μ‘ν•λ”μ§€ ν™•μΈν•΄λ³΄μ.
